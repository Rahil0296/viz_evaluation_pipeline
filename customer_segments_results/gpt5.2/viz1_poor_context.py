'''
POOR CONTEXT PROMPT USED:

The Customer Segments dataset contains marketing-related information about customers.
Create a visualization that shows the main clusters or patterns in the data.
Provide ONLY the Python code wrapped in triple backticks.
'''

import pandas as pd
from sklearn.preprocessing import StandardScaler
from sklearn.decomposition import PCA
from sklearn.cluster import KMeans
import matplotlib.pyplot as plt

# Load dataset (FIX 1: correct local path)
df = pd.read_csv("data/customer_segments.csv")

# Select numeric features (as generated by model â€” NOT modified)
numeric_df = df.select_dtypes(include=["number"]).dropna()

# Standardize data
scaler = StandardScaler()
scaled_data = scaler.fit_transform(numeric_df)

# Reduce to 2D using PCA
pca = PCA(n_components=2)
pca_data = pca.fit_transform(scaled_data)

# Apply KMeans clustering (as generated by model)
kmeans = KMeans(n_clusters=4, random_state=42)
labels = kmeans.fit_predict(pca_data)
centers = kmeans.cluster_centers_

# Plot clusters (as generated by model)
plt.figure()
plt.scatter(pca_data[:, 0], pca_data[:, 1])
plt.scatter(centers[:, 0], centers[:, 1], marker='x', s=200)
plt.xlabel("PCA Component 1")
plt.ylabel("PCA Component 2")
plt.title("Customer Segments: Cluster Patterns")

# FIX 2 (Execution Reliability): save instead of show
plt.savefig("customer_segments_results/gpt5.2/viz1_poor_context_output.png", dpi=300, bbox_inches="tight")
plt.close()
